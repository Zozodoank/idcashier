========================================
HPP FEATURE - FILE STRUCTURE
========================================

ğŸ“ ROOT FILES (Dokumentasi)
â”œâ”€â”€ HPP_QUICK_START.md              â­ Start here! Quick setup guide
â”œâ”€â”€ HPP_IMPLEMENTATION_GUIDE.md     ğŸ“š Complete technical documentation
â”œâ”€â”€ HPP_DEPLOYMENT_SUMMARY.md       ğŸ“‹ Deployment checklist & summary
â””â”€â”€ HPP_FILES_STRUCTURE.txt         ğŸ“ This file

ğŸ“ MIGRATIONS (Database)
â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ 000_apply_hpp_migrations.sql   â­ COMBINED - Use this!
â”‚   â”œâ”€â”€ 001_add_hpp_to_products.sql
â”‚   â”œâ”€â”€ 002_add_cost_snapshot.sql
â”‚   â”œâ”€â”€ 003_create_sale_custom_costs.sql
â”‚   â”œâ”€â”€ 004_add_hpp_settings.sql
â”‚   â””â”€â”€ 005_add_hpp_permissions.sql

ğŸ“ COMPONENTS (New React Components)
â”œâ”€â”€ src/components/
â”‚   â”œâ”€â”€ HPPSettings.jsx              â­ HPP feature toggle
â”‚   â””â”€â”€ CustomCostsInput.jsx         â­ Custom costs input

ğŸ“ MODIFIED FILES (Updated)
â”œâ”€â”€ src/lib/
â”‚   â”œâ”€â”€ api.js                       âœï¸ Added settingsAPI
â”‚   â””â”€â”€ translations.js              âœï¸ Added HPP translations (25+ keys)
â”œâ”€â”€ src/pages/
â”‚   â”œâ”€â”€ SettingsPage.jsx             âœï¸ Added HPP tab
â”‚   â””â”€â”€ SalesPage.jsx                âœï¸ Added custom costs section

ğŸ“ BACKUP (Safety)
â””â”€â”€ supabase-schema-backup-20251025-222346.sql

========================================
DEPLOYMENT FLOW
========================================

1. MIGRATION (Supabase SQL Editor)
   â””â”€â”€ Copy: migrations/000_apply_hpp_migrations.sql
   â””â”€â”€ Paste & Run in Supabase

2. VERIFY (SQL Queries)
   â””â”€â”€ Check tables: app_settings, sale_custom_costs
   â””â”€â”€ Check columns: products.hpp, sale_items.*

3. DEPLOY FRONTEND
   â””â”€â”€ Already built! (npm run build)
   â””â”€â”€ Deploy dist/ folder

4. ACTIVATE FEATURE
   â””â”€â”€ Login â†’ Settings â†’ HPP tab
   â””â”€â”€ Toggle "Aktifkan Fitur HPP" ON

5. TEST
   â””â”€â”€ Sales page â†’ Add custom costs
   â””â”€â”€ Verify calculations correct

========================================
FILE PURPOSES
========================================

ğŸ“š DOCUMENTATION:
HPP_QUICK_START.md
  â†’ For: Users who want quick setup
  â†’ Contains: 3-step deployment guide
  â†’ Time: 5 minutes read

HPP_IMPLEMENTATION_GUIDE.md
  â†’ For: Developers & technical team
  â†’ Contains: Complete architecture, schema, troubleshooting
  â†’ Time: 20 minutes read

HPP_DEPLOYMENT_SUMMARY.md
  â†’ For: Project managers & stakeholders
  â†’ Contains: Overview, checklist, business impact
  â†’ Time: 10 minutes read

ğŸ—„ï¸ MIGRATIONS:
000_apply_hpp_migrations.sql
  â†’ MAIN FILE - Use this for deployment
  â†’ Combines all 5 migrations
  â†’ Safe to run (no data loss)
  â†’ Idempotent (safe to re-run)

001-005_*.sql
  â†’ Individual migration files
  â†’ For reference or step-by-step execution
  â†’ Can be run separately if needed

ğŸ¨ COMPONENTS:
HPPSettings.jsx
  â†’ Feature toggle in Settings page
  â†’ Shows info when enabled
  â†’ Owner/admin only

CustomCostsInput.jsx
  â†’ Dynamic cost input (label + amount)
  â†’ Shows only if HPP enabled + permission
  â†’ Auto-calculates totals

âœï¸ UPDATES:
api.js
  â†’ Added: settingsAPI.get()
  â†’ Added: settingsAPI.update()
  â†’ Uses: app_settings table

translations.js
  â†’ Added: 25 HPP-related keys
  â†’ Languages: EN, ID, ZH
  â†’ Keys: hpp, customCosts, permissions, etc.

SettingsPage.jsx
  â†’ Added: HPP tab (6th tab)
  â†’ Integrated: HPPSettings component
  â†’ Icon: DollarSign

SalesPage.jsx
  â†’ Added: CustomCostsInput (conditional)
  â†’ Position: Below Tax field
  â†’ Shows: Only if HPP enabled + permission

========================================
DATABASE CHANGES
========================================

NEW TABLES (2):
1. app_settings
   - Stores: User settings (HPP toggle)
   - Unique: (user_id, setting_key)

2. sale_custom_costs
   - Stores: Custom costs per sale
   - Related: sales table (FK)

NEW COLUMNS (4):
1. products.hpp
   - Type: NUMERIC(10, 2)
   - Purpose: Base cost of goods

2. sale_items.cost_snapshot
   - Type: NUMERIC(10, 2)
   - Purpose: HPP at time of sale

3. sale_items.hpp_extra
   - Type: NUMERIC(10, 2)
   - Purpose: Additional costs allocated

4. sale_items.hpp_total
   - Type: NUMERIC(10, 2)
   - Purpose: Total HPP (base + extra)

UPDATED COLUMNS (1):
users.permissions (JSONB)
   - Added: canViewHPP
   - Added: canEditHPP
   - Added: canAddCustomCosts

========================================
FEATURE BEHAVIOR
========================================

DEFAULT STATE (HPP Disabled):
âœ… No UI changes
âœ… No impact on existing workflows
âœ… Zero performance impact
âœ… Backward compatible

WHEN ENABLED (HPP Active):
âœ… Settings: HPP tab visible
âœ… Sales: Custom costs input appears
âœ… Products: HPP column visible (if permission)
âœ… Reports: Profit calculation includes HPP

PERMISSIONS:
Owner/Admin:
  âœ… Can toggle HPP feature
  âœ… Can view HPP data
  âœ… Can edit HPP values
  âœ… Can add custom costs

Cashier (default):
  âŒ Cannot view HPP
  âŒ Cannot edit HPP
  âŒ Cannot add custom costs
  (Can be granted by owner)

========================================
QUICK REFERENCE
========================================

Supabase Project:
https://supabase.com/dashboard/project/eypfeiqtvfxxiimhtycc

SQL Editor:
https://supabase.com/dashboard/project/eypfeiqtvfxxiimhtycc/sql/new

Logs:
https://supabase.com/dashboard/project/eypfeiqtvfxxiimhtycc/logs

Application:
https://idcashier.my.id

========================================
SUPPORT & TROUBLESHOOTING
========================================

Issue: Migration fails
â†’ Check: Supabase logs
â†’ Fix: Run migrations one by one

Issue: HPP tab not showing
â†’ Check: Hard refresh (Ctrl+Shift+R)
â†’ Fix: Clear browser cache

Issue: Custom costs not visible
â†’ Check: HPP enabled in Settings?
â†’ Check: User has permission?
â†’ Fix: Grant permission or enable HPP

Issue: Settings API error
â†’ Check: app_settings table exists?
â†’ Fix: Run migration 004

========================================
SUCCESS METRICS
========================================

âœ… 0 Breaking Changes
âœ… 0 Data Loss
âœ… 100% Backward Compatible
âœ… Build: Success (no errors)
âœ… Migrations: Ready to apply
âœ… Documentation: Complete

========================================
NEXT ACTION
========================================

â­ DEPLOY NOW:
1. Open: migrations/000_apply_hpp_migrations.sql
2. Copy all content
3. Paste in Supabase SQL Editor
4. Click "Run"
5. Enable HPP in Settings â†’ HPP tab
6. âœ… Done!

========================================
END OF FILE STRUCTURE
========================================

